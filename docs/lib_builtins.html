<!DOCTYPE html><html><head><title>Phoo docs for lib/_builtins.js</title><style>code+.description{display:none;opacity:50%}code:hover+.description{display:inline-block}.shadowed{opacity:50%}</style></head><body><h2 id="/*"><code>/*</code>  (  &rarr;  )</h2>
<p>Block comment. Like C-style comments. Comments do not nest.</p>
<h2 id="$"><code>$</code>  (  &rarr; <code>s</code><em class="description">The string (or regular expression) defined by the literal.</em> )</h2>
<p>String builder.</p>
<p>First non-whitespace character after the <code>$</code> is the delimiter. The delimiter can be escaped by doubling it.</p>
<p>The characters immediately following the end delimiter are known as the &ldquo;tag&rdquo; and affect the resultant string. The first character is the code that determines the formatting applied.</p>
<p>Currently the only one implemented is <code>r</code>, which turns the string into a regular expression. The characters after the <code>r</code> are the flags that would go at the end of it. There is no way to &ldquo;escape&rdquo; any characters other than the delimiter, but a <code>e</code> code for defining an escape character is planned. See issue <a href="https://github.com/dragoncoder047/phoo/issues/8">#8</a> for the status of that.</p>
<p>Example:</p>
<pre><code class="language-phoo">
$ 5ab*c?5rig
// puts the regular expression /ab*c?/ig.
</code></pre>
<h2 id="do"><code>do</code>  (  &rarr;  )</h2>
<p>Starts of a new sub-array.</p>
<h2 id="["><code>[</code>  (  &rarr;  )</h2>
<p>Same as <code>do</code>.</p>
<h2 id="end"><code>end</code>  (  &rarr;  )</h2>
<p>End of a sub-array.</p>
<h2 id="]"><code>]</code>  (  &rarr;  )</h2>
<p>Same as <code>end</code>.</p>
<h2 id="pick"><code>pick</code>  ( <code>n</code><em class="description">Depth of item to pick</em> &rarr; <code>i</code><em class="description">COPY of the item.</em> )</h2>
<p>Same as the Forth word <code>PICK</code>. Takes a number <code>n</code> and <strong>copies</strong> the nth item to the top.</p>
<p><strong>See Also:</strong> <a href="#roll"><code>roll</code></a></p>
<h2 id="roll"><code>roll</code>  ( <code>n</code><em class="description">Depth of item to pick</em> &rarr; <code>i</code><em class="description">COPY of the item.</em> )</h2>
<p>Same as the Forth word <code>ROLL</code>. Takes a number <code>n</code> and <strong>moves</strong> the nth item to the top .</p>
<p><strong>See Also:</strong> <a href="#pick"><code>pick</code></a></p>
<h2 id="drop"><code>drop</code>  ( <code>n</code>**{.description} &rarr;  )</h2>
<p>Removes the top item from the stack.</p>
<h2 id="1+"><code>1+</code>  ( <code>n</code><strong class="description">{.description} &rarr; <code>n+1</code></strong> )</h2>
<p>Increments a number on the top of the stack.</p>
<h2 id="1-"><code>1-</code>  ( <code>n</code><strong class="description">{.description} &rarr; <code>n-1</code></strong> )</h2>
<p>Decrements a number on the top of the stack.</p>
<h2 id="+"><code>+</code>  ( <code>a</code><strong class="description">{.description} <code>b</code></strong> &rarr; <code>b+a</code>**{.description} )</h2>
<p>Adds two items together using Javascript <code>+</code> operator. Note the order of addition.</p>
<h2 id="negate"><code>negate</code>  ( <code>a</code><strong class="description">{.description} &rarr; <code>-a</code></strong> )</h2>
<p>Unary negation of top item.</p>
<h2><code>*</code>  ( <code>a</code><strong class="description">{.description} <code>b</code></strong> &rarr; <code>b*a</code>*<em>{.description} ) {#</em>}</h2>
<p>Multiply top items.</p>
<h2><code>**</code>  ( <code>b</code><em class="description">base</em> <code>e</code><em class="description">exponent</em> &rarr; <code>b**e</code><strong>{.description} ) {#</strong>}</h2>
<p>Power of top two items.</p>
<h2 id="/mod"><code>/mod</code>  ( <code>x</code><em class="description">dividend</em> <code>y</code><em class="description">divisor</em> &rarr; <code>q</code><em class="description">quotient</em> <code>r</code><em class="description">remainder</em> )</h2>
<p>Euclidean division. Remainder and quotient.</p>
<h2 id="/"><code>/</code>  ( <code>a</code><em class="description">dividend</em> <code>b</code><em class="description">divisor</em> &rarr; <code>q</code><em class="description">quotient</em> )</h2>
<p>Regular division (results in float).</p>
<h2 id=""><code>=</code>  ( <code>a</code><strong class="description">{.description} <code>b</code></strong> &rarr; <code>t</code>**{.description} )</h2>
<p>Equals, using Javascript <code>==</code> operator.</p>
<h2 id="&gt;"><code>&gt;</code>  ( <code>a</code><em class="description">number on &ldquo;larger&rdquo; (left) side of expression.</em> <code>b</code><em class="description">number on &ldquo;smaller&rdquo; (right) side of expression.</em> &rarr; <code>t</code>**{.description} )</h2>
<p>Greater than.</p>
<h2 id="nand"><code>nand</code>  ( <code>a</code><strong class="description">{.description} <code>b</code></strong> &rarr; <code>t</code>**{.description} )</h2>
<p>Boolean NAND of two arguments. True if both are false.</p>
<h2 id="~"><code>~</code>  ( <code>n</code><strong class="description">{.description} &rarr; <code>~n</code></strong> )</h2>
<p>Bitwise NOT of a number.</p>
<h2 id="&amp;"><code>&amp;</code>  ( <code>a</code><strong class="description">{.description} <code>b</code></strong> &rarr; <code>a&amp;b</code>**{.description} )</h2>
<p>Bitwise AND of two numbers.</p>
<h2 id="|"><code>|</code>  ( <code>a</code><strong class="description">{.description} <code>b</code></strong> &rarr; <code>a|b</code>**{.description} )</h2>
<p>Bitwise OR of two numbers.</p>
<h2 id="^"><code>^</code>  ( <code>a</code><strong class="description">{.description} <code>b</code></strong> &rarr; <code>a^b</code>**{.description} )</h2>
<p>Bitwise XOR of two numbers.</p>
<h2 id="&lt;&lt;"><code>&lt;&lt;</code>  ( <code>a</code><strong class="description">{.description} <code>b</code></strong> &rarr; <code>a&lt;&lt;b</code>**{.description} )</h2>
<p>A bit-shifted left by B places. Negative B for shift right.</p>
<h2 id="put"><code>put</code>  ( <code>i</code><em class="description">Item to push</em> <code>a</code><em class="description">Array to push onto</em> &rarr;  )</h2>
<p>Pushes the item onto the end of the array.</p>
<p><strong>See Also:</strong> <a href="#take"><code>take</code></a></p>
<h2 id="take"><code>take</code>  ( <code>a</code><em class="description">Array</em> &rarr; <code>i</code><em class="description">Last item of the array</em> )</h2>
<p>Reverse of <a href="#put"><code>put</code></a>, it takes the item out of the array. The array is mutated.</p>
<h2 id="]done["><code>]done[</code>  (  &rarr;  )</h2>
<p>Drops the top item of the return stack, effectively causing everything else outside of the current word to be skipped.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ foo [ ]done[ bar ] baz ]
// foo and then bar are run, but baz is skipped.
</code></pre>
<h2 id="]again["><code>]again[</code>  (  &rarr;  )</h2>
<p>Sets the return pointer of the top return stack item to -1, effectively causing everything else outside of the current word to be repeated.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ foo [ ]again[ bar ] baz ]
// runs foo bar foo bar foo bar foo bar ... infintely
</code></pre>
<h2 id="]cjump["><code>]cjump[</code>  ( <code>t</code><em class="description">truth value to test</em> <code>n</code><em class="description">how far to jump if false</em> &rarr;  )</h2>
<p>If the test value <code>t</code> is false, adds <code>n</code> to the top return stack entry&rsquo;s return pointer, effectively skipping that many items.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ 3 ]cjump[ ] foo bar baz bam
// if ToS is false, skips foo bar baz. bam will always run
</code></pre>
<h2 id="]'["><code>]'[</code>  (  &rarr; <code>a</code>**{.description} )</h2>
<p>Instead of running the next item on the top return stack entry, pushes it to the stack and crements the return stack pointer.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ ]'[ drop ] foo bar
// foo will be pushed to the stack and then dropped, rendering it a noop. bar will run.
</code></pre>
<h2 id="]run["><code>]run[</code>  ( <code>a</code>**{.description} &rarr;  )</h2>
<p>Pushes the item to the return stack, so that it will run when the current word finishes.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ table a b c ] [ ]run[ ]
// if ToS is n, runs nth item of the table.
</code></pre>
<h2 id="]this["><code>]this[</code>  ( <code>a</code>**{.description} &rarr;  )</h2>
<p>Pushes the top array on the return stack to the work stack, so that the word can reference its caller.</p>
<h2 id="[]"><code>[]</code>  (  &rarr; <code>a</code>**{.description} )</h2>
<p>Pushes <code>a</code> new, empty array to the work stack.</p>
<h2 id="concat"><code>concat</code>  ( <code>a</code><strong class="description">{.description} <code>b</code></strong> &rarr; <code>ab</code>**{.description} )</h2>
<p>Concatenates two arrays. non-arrays are treated like one-element arrays.</p>
<h2 id="peek"><code>peek</code>  ( <code>a</code><strong class="description">{.description} <code>i</code></strong> &rarr; <code>a[i]</code>**{.description} )</h2>
<p>Takes the <code>i</code>-th item out of the array <code>a</code>.</p>
<h2 id="poke"><code>poke</code>  ( <code>t</code><em class="description">item to poke</em> <code>a</code><em class="description">the array to be poked</em> <code>i</code><em class="description">index to poke at</em> &rarr; <code>a</code><em class="description">the array to be poked</em> )</h2>
<p>Puts the item into the specified index of the array, and leaves the new, mutated array.</p>
<h2 id="]sandbox["><code>]sandbox[</code>  ( <code>c</code><strong class="description">{.description} &rarr; <code>e</code></strong> )</h2>
<p>Runs the code under a <code>try</code> statement, and pushes the error it threw, or <code>false</code> if no error.</p>
<h2 id="die"><code>die</code>  ( <code>m</code>**{.description} &rarr;  )</h2>
<p>Throws a <code>PhooError</code> with the message.</p>
<h2 id="]getstack["><code>]getstack[</code>  ( <code>e</code><strong class="description">{.description} &rarr; <code>t</code></strong> )</h2>
<p>With a <code>PhooError</code> on the top, gets its Phoo stack trace.</p>
<h2 id="type"><code>type</code>  ( <code>o</code><strong class="description">{.description} &rarr; <code>t</code></strong> )</h2>
<p>Gets the type of the object.</p>
<h2 id="compile"><code>compile</code>  ( <code>s</code><strong class="description">{.description} &rarr; <code>a</code></strong> )</h2>
<p>Compiles the string, so that it can be run.</p>
<h2 id="time"><code>time</code>  (  &rarr; <code>t</code>**{.description} )</h2>
<p>Pushes the system time, in milliseconds.</p>
<h2 id="await"><code>await</code>  ( <code>p</code><strong class="description">{.description} &rarr; <code>v</code></strong> )</h2>
<p>Awaits a <code>Promise</code> and pushes the resolve value.</p>
<h2 id="get"><code>get</code>  ( <code>o</code><em class="description">object</em> <code>k</code><em class="description">string key</em> &rarr; <code>v</code><em class="description">o.k</em> )</h2>
<p>Object and key, looks up.</p>
<h2 id="set"><code>set</code>  ( <code>v</code><em class="description">value to set</em> <code>o</code><em class="description">object</em> <code>k</code><em class="description">string key</em> &rarr;  )</h2>
<p>Value, object, and key, sets the key.</p>
<h2 id="call"><code>call</code>  ( <code>a</code><em class="description">arguments array</em> <code>f</code><em class="description">function</em> &rarr; <code>r</code><em class="description">return value</em> )</h2>
<p>Calls <code>a</code> function with the arguments.</p>
<p><strong>See Also:</strong> <a href="#new"><code>new</code></a></p>
<h2 id="new"><code>new</code>  ( <code>a</code><em class="description">arguments array</em> <code>f</code><em class="description">constructor function</em> &rarr; <code>r</code><em class="description">new object constructed</em> )</h2>
<p>Same sort as <a href="#call"><code>call</code></a>, but uses Javascript <code>new</code> keyword to construct with <code>a</code> class.</p>
<h2 id="word"><code>word</code>  ( <code>s</code><em class="description">string</em> &rarr; <code>w</code><em class="description">symbol of that string</em> )</h2>
<p>Converts string to symbol.</p>
<h2 id="name"><code>name</code>  ( <code>w</code><em class="description">symbol</em> &rarr; <code>s</code><em class="description">string of that symbol</em> )</h2>
<p>Reverse of <a href="#word"><code>word</code></a>, converts symbol to string.</p>
<h2 id="resolve"><code>resolve</code>  ( <code>w</code><em class="description">symbol</em> &rarr; <code>d</code><em class="description">definition</em> )</h2>
<p>Looks up the definition of the word symbol.</p>
<h2><code>{}</code>  (  &rarr; <code>a</code>**{.description} ) {#{}}</h2>
<p>Pushes <code>a</code> new empty object.</p>
<h2 id="self"><code>self</code>  (  &rarr; <code>t</code>**{.description} )</h2>
<p>Pushes a reference to the current thread.</p>
<h2 id="window"><code>window</code>  (  &rarr; <code>t</code>**{.description} )</h2>
<p>Pushes a reference to the global Javascript object (<code>globalThis</code>). Called &ldquo;window&rdquo; because that is its name in the browser which is what Phoo was designed for.</p>
<h2 id="]define["><code>]define[</code>  ( <code>n</code><em class="description">symbol name</em> <code>d</code><em class="description">definition</em> &rarr;  )</h2>
<p>Writes a new definition to the top scope using the name and definition on the stack.</p>
<h2 id="]define-macro["><code>]define-macro[</code>  ( <code>n</code><em class="description">symbol name</em> <code>d</code><em class="description">definition</em> &rarr;  )</h2>
<p>Like <a href="#]define["><code>]define[</code></a> but defines a macro.</p>
<h2 id="]forget["><code>]forget[</code>  ( <code>n</code><em class="description">symbol name</em> &rarr;  )</h2>
<p>Erases the definition of a word, reverting back to the old one if there was one.</p>
<h2 id="to"><code>to</code> <em class="shadowed"><code>name</code></em> <em class="shadowed"><code>def</code></em> (  &rarr;  )</h2>
<p>Wrapper for <a href="#]define["><code>]define[</code></a>.</p>
<h2 id="macro"><code>macro</code> <em class="shadowed"><code>name</code></em> <em class="shadowed"><code>def</code></em> (  &rarr;  )</h2>
<p>Wrapper for <a href="#]define-macro["><code>]define-macro[</code></a>.</p>
<h2 id="forget"><code>forget</code> <em class="shadowed"><code>name</code></em> (  &rarr;  )</h2>
<p>Wrapper for <a href="#]forget["><code>]forget[</code></a>.</p>
<h2 id="]import["><code>]import[</code>  ( <code>n</code><em class="description">name of the module</em> <code>r</code><em class="description">boolean, force-reload the module</em> &rarr;  )</h2>
<p>Imports the module, force-reloading if the top is true (ignores cache).</p>
<h2 id="promise"><code>promise</code>  (  &rarr; <code>p</code><em class="description">the promise</em> <code>x</code><em class="description">reject callback</em> <code>r</code><em class="description">resolve callback</em> )</h2>
<p>Pushes the pieces to a new promise.</p>
<h2 id="functionize"><code>functionize</code>  ( <code>c</code><strong class="description">{.description} &rarr; <code>f</code></strong> )</h2>
<p>Turns the code into a function, that will run the code in a subthread.</p></body></html>